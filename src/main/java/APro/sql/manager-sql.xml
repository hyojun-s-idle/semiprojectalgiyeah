<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE properties SYSTEM "http://java.sun.com/dtd/properties.dtd">
<properties>
<comment>manager-sql.xml</comment>

	<!-- 신고 댓글 수 조회 -->
	<entry key="CountComment">
	SELECT COUNT(*)
	FROM(
	SELECT A.* FROM
	(SELECT B.BOARD_NO,
	    (SELECT COUNT(*) FROM REPORT WHERE R.REPLY_NO = REPORT_NO AND REPORT_TYPE = 2) RCOUNT
	FROM BOARD B
	LEFT JOIN REPLY R ON(B.BOARD_NO = R.BOARD_NO)
	WHERE BOARD_ST = 'N'
	AND REPLY_ST = 'N')A
	WHERE RCOUNT > 0
	)
	</entry>
	
	<!-- 신고 댓글 목록 조회 -->
	<entry key="commentList">
	SELECT * FROM
		(SELECT ROWNUM RNUM ,A.* FROM
				(SELECT B.BOARD_NO, B.BOARD_TITLE, BT.BOARD_NAME CATEGORY,
		                BT2.BOARD_NAME PR_BOARD,MEMBER_NICK,MEMBER_TYPE_NM,
		                (SELECT COUNT(*) FROM REPORT WHERE R.REPLY_NO = REPORT_NO AND REPORT_TYPE = 2) RCOUNT,
		                REPLY_NO, REPLY_CONTENT,
						TO_CHAR(R.CREATE_DATE,'YYYY-MM-DD') CREATE_DT, 
	                TO_CHAR(R.UPDATE_DATE, 'YYYY-MM-DD') UPDATE_DT
				FROM BOARD B
				LEFT JOIN REPLY R ON(B.BOARD_NO = R.BOARD_NO)
				LEFT JOIN BOARD_TYPE BT ON(B.BOARD_TYPE_CD = BT.BOARD_TYPE_CD) -- 카테고리
				LEFT JOIN BOARD_TYPE BT2 ON(BT.PR_BOARD = BT2.BOARD_TYPE_CD) -- 게시판
				LEFT JOIN MEMBER M ON(M.MEMBER_NO = R.MEMBER_NO)
				LEFT JOIN MEMBER_TYPE MT ON(M.MEMBER_TYPE_CD = MT.MEMBER_TYPE_CD)
				WHERE BOARD_ST = 'N'
				AND REPLY_ST = 'N')A
		WHERE RCOUNT > 0
		ORDER BY RCOUNT DESC)
	WHERE RNUM BETWEEN ? AND ?
	</entry>
	
	<!-- 신고 댓글 상세 조회 -->
	<entry key="commentDetail">
	SELECT B.BOARD_NO, BT.BOARD_NAME CATEGORY,
                BT2.BOARD_NAME PR_BOARD,MEMBER_NICK,MEMBER_TYPE_NM,
                (SELECT COUNT(*) FROM REPORT WHERE R.REPLY_NO = REPORT_NO AND REPORT_TYPE = 2) RCOUNT,
                REPLY_NO, REPLY_CONTENT,
                TO_CHAR(R.CREATE_DATE,'YYYY-MM-DD') CREATE_DT, 
	                TO_CHAR(R.UPDATE_DATE, 'YYYY-MM-DD') UPDATE_DT
	FROM BOARD B
	LEFT JOIN REPLY R ON(B.BOARD_NO = R.BOARD_NO)
	LEFT JOIN BOARD_TYPE BT ON(B.BOARD_TYPE_CD = BT.BOARD_TYPE_CD) -- 카테고리
	LEFT JOIN BOARD_TYPE BT2 ON(BT.PR_BOARD = BT2.BOARD_TYPE_CD) -- 게시판
	LEFT JOIN MEMBER M ON(M.MEMBER_NO = R.MEMBER_NO)
	LEFT JOIN MEMBER_TYPE MT ON(M.MEMBER_TYPE_CD = MT.MEMBER_TYPE_CD)
	WHERE BOARD_ST = 'N'
	AND REPLY_ST = 'N'
	AND REPLY_NO = ?
	</entry>
	
	<!-- 신고 댓글 사유 목록 조회 -->
	<entry key="commentReson">
	SELECT REPORT_CONTENT, 
			TO_CHAR(REPORT_DATE, 'YYYY-MM-DD')
	FROM REPORT
	LEFT JOIN REPLY ON(REPORT_NO = REPLY_NO)
	WHERE REPLY_ST = 'N'
	AND REPORT_TYPE = 2
	AND REPORT_NO = ?
	</entry>
	
	<!-- 신고 게시판 수 조회 -->
	<entry key="postCount">
	SELECT COUNT(*)
	FROM (SELECT ROWNUM RNUM,A.* FROM
	(SELECT B.BOARD_NO,
	    (SELECT COUNT(*) FROM REPORT WHERE BOARD_NO = REPORT_NO AND REPORT_TYPE = 1) RCOUNT
	FROM BOARD B
	WHERE BOARD_ST ='N')A
	WHERE RCOUNT > 0)
	</entry>
	
	<!-- 신고 게시판 목록 조회 -->
	<entry key="postList">
	SELECT * FROM
	(SELECT ROWNUM RNUM,A.* FROM
		(SELECT B.BOARD_NO,B.BOARD_TITLE,B.BOARD_CONTENT, BT.BOARD_NAME CATEGORY, BT2.BOARD_NAME PR_BOARD,
		    (SELECT COUNT(*) FROM REPORT WHERE BOARD_NO = REPORT_NO AND REPORT_TYPE = 1) RCOUNT,
		    MEMBER_NICK,MEMBER_TYPE_NM,
		    			TO_CHAR(B.CREATE_DT,'YYYY-MM-DD') CREATE_DT, 
		                TO_CHAR(B.UPDATE_DT, 'YYYY-MM-DD') UPDATE_DT
			FROM BOARD B
			LEFT JOIN BOARD_TYPE BT ON(B.BOARD_TYPE_CD = BT.BOARD_TYPE_CD) -- 카테고리
			LEFT JOIN BOARD_TYPE BT2 ON(BT.PR_BOARD = BT2.BOARD_TYPE_CD) -- 게시판
			LEFT JOIN MEMBER M ON(M.MEMBER_NO = B.MEMBER_NO)
			LEFT JOIN MEMBER_TYPE MT ON(M.MEMBER_TYPE_CD = MT.MEMBER_TYPE_CD)
			WHERE BOARD_ST ='N'
			ORDER BY RCOUNT DESC)A
		WHERE RCOUNT > 0
		ORDER BY RCOUNT DESC)
	WHERE RCOUNT BETWEEN ? AND ?
	</entry>
	
	<!-- 신고 게시판 상세 조회 -->
	<entry key="postDetail">
	SELECT BOARD_NO,BOARD_TITLE, BOARD_CONTENT, BT.BOARD_NAME CATEGORY,
        BT2.BOARD_NAME PR_BOARD, MEMBER_NICK,MEMBER_TYPE_NM,
        (SELECT COUNT(*) FROM REPORT WHERE BOARD_NO = REPORT_NO AND REPORT_TYPE = 1) RCOUNT
        ,TO_CHAR(B.CREATE_DT,'YYYY-MM-DD') CREATE_DT, 
                TO_CHAR(B.UPDATE_DT, 'YYYY-MM-DD') UPDATE_DT
	FROM BOARD B
	LEFT JOIN BOARD_TYPE BT ON(B.BOARD_TYPE_CD = BT.BOARD_TYPE_CD)
	LEFT JOIN BOARD_TYPE BT2 ON(BT.PR_BOARD = BT2.BOARD_TYPE_CD)
	LEFT JOIN MEMBER M ON(M.MEMBER_NO = B.MEMBER_NO)
	LEFT JOIN MEMBER_TYPE MT ON(M.MEMBER_TYPE_CD = MT.MEMBER_TYPE_CD)
	WHERE BOARD_ST = 'N'
	AND B.BOARD_NO = ?
	</entry>
	
	<!-- 신고 게시판 신고 사유 목록 조회 -->
	<entry key="postReson">
	SELECT REPORT_CONTENT,
        TO_CHAR(REPORT_DATE, 'YYYY-MM-DD')
	FROM REPORT
	LEFT JOIN BOARD ON(REPORT_NO = BOARD_NO)
	WHERE BOARD_ST = 'N'
	AND REPORT_TYPE = 1
	AND REPORT_NO = ?
	</entry>

	<!-- 회원 수 조회  -->
	<entry key="memberCount">
	SELECT COUNT(*) FROM MEMBER
	</entry>
	
	<!-- 회원 목록 조회 -->
	<entry key="memberList">
	SELECT MEMBER_NO,MEMBER_ID,MEMBER_TYPE_NM, MEMBER_NM, MEMBER_NICK, MEMBER_TEL
    		,MEMBER_EMAIL,MEMBER_ADRR, BUSINESS_NUM, SECESSION_FL
	FROM MEMBER
	LEFT JOIN MEMBER_TYPE USING(MEMBER_TYPE_CD)
	</entry>

</properties>
